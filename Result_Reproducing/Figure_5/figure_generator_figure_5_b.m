function figure_generator_figure_5_b(singular_values)
% Function to plot figure 5.b
% This figure plot the ratio between sigma^r and sigma^{r+1} at each iterate
%   for incomplete signal recovery experiment when input rank is
%   mis-approximated

fprintf('\n-------------------------------------------------');
fprintf('\n Step 4/4: generate Fig_5(b), singular value plotting');

f = figure('visible','off');

singular_value_FIHT = log(singular_values{1});

iterations_fiht = max(size(singular_value_FIHT));

iterations = 50;
Line_FIHT = line((1 : iterations_fiht)', singular_value_FIHT(1:iterations_fiht, 1)); 

font_size =24;

singular_value_PGD = log(singular_values{2});
Line_PGD = line((1 : iterations)', singular_value_PGD(1:iterations, 1)); 

singular_value_pMAP = log(singular_values{3});
Line_pMAP = line((1 : iterations)', singular_value_pMAP(1:iterations, 1)); 

set(Line_FIHT, ...                        
    'LineStyle',    '-'   , ...
    'LineWidth',    1,  ...
    'color'    ,  [34 100 100]/255,  ...
    'Marker'   , 'v'      , ...
    'MarkerSize'  , 7 , ...
    'MarkerEdgeColor', [34 100 100]/255, ...
    'MarkerFaceColor', [34 100 100]/255);

set(Line_PGD, ...                         
    'LineStyle',    '-'   , ...
    'LineWidth',    1,  ...
    'color'    ,  [202 38 40]/255,  ...
    'Marker'   , 'o'      , ...
    'MarkerSize'  , 7 , ...
    'MarkerEdgeColor', [202 38 40]/255, ...
    'MarkerFaceColor', [202 38 40]/255);

set(Line_pMAP, ...
    'color'             ,  [43,140,190]/255    , ...
    'LineStyle'         ,  '-'         , ...
    'LineWidth'         , 1     , ...
    'Marker'            ,  's'          , ...
    'MarkerSize'        ,  7            , ...
    'MarkerEdgeColor'   ,  [43,140,190]/255   , ...
    'MarkerFaceColor'   ,  [44, 127, 184]/255);

set(gca,'FontSize',font_size);
set(gca,'XTick',0:5:200);
ylabel('$log(\sigma_i)$', 'Interpreter','latex', 'fontsize',font_size);
xlabel('Singular Value Index', 'fontsize',font_size);
set(gcf,'Position',[100 100 800 600]);
title('Singular value plot for the approximation result', 'fontsize',font_size,  'Interpreter','latex')
SLegend = legend( ...
    [Line_FIHT, Line_PGD, Line_pMAP], ...
    'FIHT', 'PGD', 'pMAP', ...
    'location', 'Best');
set(SLegend,'Interpreter','latex','FontSize', font_size);

saveas(f,'Output/Fig_5(b).eps','epsc')

fprintf('\n-------------------------------------------------');
fprintf('\n Figure 5.b succesfully generated. Please find the Fig_5(b).eps in /Output folder');
fprintf('\n-------------------------------------------------\n');

end

