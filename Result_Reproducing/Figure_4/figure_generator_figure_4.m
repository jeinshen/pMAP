function figure_generator_figure_4(kpi_data_incorrect_rank)

% Method to plot Figure 4 using generated kpi data (kpi_data_incorrect_rank)

fprintf('\n-------------------------------------------------');
fprintf('\n Step 4/4: generate and save figures for Figure 4');

f = figure('visible','off');

[~, N] = size(kpi_data_incorrect_rank);
T = (1 : N)';

kpi_FIHT = kpi_data_incorrect_rank(1, :);
SFIHT = line(T, kpi_FIHT);

kpi_PGD = kpi_data_incorrect_rank(2, :);
SPGD = line(T, kpi_PGD);

kpi_pMAP = kpi_data_incorrect_rank(3, :);
SpMAP = line(T, kpi_pMAP);

hold on

figure_font_size = 18;

linewidth = 1.5;

set(SFIHT, ...
    'color'             ,  'r'    , ...
    'LineStyle'         ,  '--'         , ...
    'LineWidth'         , linewidth     , ...
    'Marker'            ,  's'          , ...
    'MarkerSize'        ,  8            , ...
    'MarkerEdgeColor'   ,  [.6 .6 .6]   , ...
    'MarkerFaceColor'   ,  [.7 .7 .7]);

set(SPGD, ...
    'color'             ,  'b'    , ...
    'LineStyle'         ,  ':'         , ...
    'LineWidth'         , linewidth     , ...
    'Marker'            ,  '.'          , ...
    'MarkerSize'        ,  20            , ...
    'MarkerEdgeColor'   ,  [.1 .1 1]   , ...
    'MarkerFaceColor'   ,  [.2 .3 .8]);

set(SpMAP, ...
    'color'             ,  [0.5 0 0.5]    , ...
    'LineStyle'         ,  '--'         , ...
    'LineWidth'         , linewidth     , ...
    'Marker'            ,  'd'          , ...
    'MarkerSize'        ,  8            , ...
    'MarkerEdgeColor'   ,  [.7 .1 .7]   , ...
    'MarkerFaceColor'   ,  [1 .1 .1]);

set(gca,'FontSize',figure_font_size);
ylabel('Success Recovery Rate');
xlabel('Approximated Input Rank');
xticklabels({'6','9','12','15','18','21','24','27','30'});
set(gca,'XTick',1:1:9);
set(gcf,'Position',[100 100 800 400]);
SLegend = legend( ...
    [SFIHT,SPGD,SpMAP], ...
    'FIHT', 'PGD','pMAP', ...
    'location', 'Best');
set(SLegend,'FontSize', figure_font_size);

saveas(f,'Output/Fig_4.eps','epsc')
fprintf('\n-------------------------------------------------');
fprintf('\n Figure 4 succesfully generated. Please find the Fig_4.eps in Output folder');
fprintf('\n-------------------------------------------------\n');

end

